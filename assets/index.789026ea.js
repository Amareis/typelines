import{t as g,G as F,d as M,c as P,a as W,o as Y,b as A,i as b,e as _,f as B,F as G,g as X,r as I}from"./vendor.27482df5.js";const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))y(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&y(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerpolicy&&(u.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?u.credentials="include":l.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function y(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}};J();const L=[[240,163,255],[0,117,220],[153,63,0],[76,0,92],[25,25,25],[0,92,49],[43,206,72],[255,204,153],[128,128,128],[143,124,0],[157,204,0],[194,0,136],[0,51,128],[255,164,5],[255,168,187],[66,102,0],[255,0,16],[0,153,143],[116,10,255],[153,0,0],[255,80,5]],O=g("<div></div>"),R=g('<textarea autocorrect="off" autocapitalize="none"></textarea>'),T=g("<div>&nbsp;</div>"),q=new F;function k(a,t){return(()=>{const r=O.cloneNode(!0);return r.style.setProperty("position","absolute"),r.style.setProperty("white-space","pre"),r.style.setProperty("color",t),b(r,a),r})()}const E=320,S=320;function z(a){let t=0;for(let r=0;r<a.length;r++)t=(t<<5)-t+a.charCodeAt(r)|0;return t}const H=()=>{let a,t,[r,y]=P(20),[l,u]=P(S/2-10),[f,d]=P(r()),[x,$]=P(l()),h;const m=W({});Y(()=>{t.value=" ",t.focus(),h=new WebSocket("wss://worker.terma95.workers.dev/api/ws"),h.addEventListener("message",e=>{const{message:i,id:s}=JSON.parse(e.data);i?i.l?j(s,i.l,i.x,i.y):w(s,i.x,i.y):delete m[s]})});function w(e,i,s){let o=m[e];if(o)return o.x=i,o.y=s,o;const n=`rgb(${L[z(e)%L.length].join(",")})`;return m[e]={x:i,y:s,color:n}}function v(e){h.send(JSON.stringify({message:{l:e,x:f(),y:x()}}))}A(()=>{h.close(),console.log("clear!")});function j(e,i,s,o){const n=w(e,s,o),c=k(i,n.color);a.appendChild(c),c.style.bottom=o+"px",c.style.left=s-c.clientWidth+"px",X({targets:c,duration:3e3,translateY:-20}).finished.then(()=>a.removeChild(c))}function C(){$(Math.max(x()-15,0))}return[(()=>{const e=O.cloneNode(!0),i=a;return typeof i=="function"?i(e):a=e,e.style.setProperty("position","relative"),e.style.setProperty("overflow","hidden"),e.style.setProperty("width","320px"),e.style.setProperty("height","320px"),e.style.setProperty("background","white"),b(e,_(G,{get each(){return Object.values(m)},children:s=>(()=>{const o=T.cloneNode(!0);return o.style.setProperty("position","absolute"),B(n=>{const c=s.y+"px",p=s.x+"px",N=s.color;return c!==n._v$&&o.style.setProperty("bottom",n._v$=c),p!==n._v$2&&o.style.setProperty("left",n._v$2=p),N!==n._v$3&&o.style.setProperty("background",n._v$3=N),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),o})()})),e})(),(()=>{const e=R.cloneNode(!0);e.$$input=s=>{const o=s.currentTarget.value;if(s.currentTarget.value=" ",!o){f()===r()?$(l()):d(r()),v("");return}if(o.includes(`
`)){d(r()),C(),v("");return}q.splitGraphemes(o.slice(1)).forEach(n=>{const c=k(n);a.appendChild(c);const p=f()+c.clientWidth;p+10<E?d(p):(d(r()),C()),a.removeChild(c),v(n)})},e.$$click=s=>{const o=a.getBoundingClientRect(),n=o.bottom-s.clientY,c=s.clientX-o.left;n<0||n>S-35||c<0||c>E-10||(u(n),y(c),d(c),$(n),v(""))};const i=t;return typeof i=="function"?i(e):t=e,e.style.setProperty("opacity","0"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-100px"),e.style.setProperty("left","0"),e.style.setProperty("width","100%"),e.style.setProperty("height","300%"),e})()]};M(["click","input"]);const K=g('<div><div id="log"></div></div>'),D=()=>{let a;return(()=>{const t=K.cloneNode(!0);t.firstChild;const r=a;return typeof r=="function"?r(t):a=t,t.style.setProperty("background","gray"),t.style.setProperty("display","flex"),t.style.setProperty("justify-content","center"),t.style.setProperty("height","100%"),t.style.setProperty("position","relative"),t.style.setProperty("overflow","hidden"),b(t,_(H,{}),null),t})()};I(()=>_(D,{}),document.getElementById("root"));
